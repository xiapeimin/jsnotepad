var $menubar=function(){var a,c=$('<div class="notepad-menubar"></div>'),d=[],r=-1;function e(){!function(){for(var t=$('<ul class="menu-title"></ul>'),e=0;e<a.length;e++){var l=$('<li class="title"></li>');l.html(a[e].title),l.attr("data-id",e),t.append(l),l.click(function(){var t=Number(this.dataset.id);r=-1===r?(d[t].css({display:"inline-block"}),t):r!==t?(d[r].css({display:"none"}),d[t].css({display:"inline-block"}),t):(d[r].css({display:"none"}),-1)}),l.hover(function(){if(-1!==r){var t=Number(this.dataset.id);d[r].css({display:"none"}),d[t].css({display:"inline-block"}),r=t}})}c.append(t)}(),function(){for(var t=0;t<a.length;t++){for(var e=$('<ul class="menus"></ul>'),l=a[t].menuItems,n=0;n<l.length;n++)if("hr"!==l[n].title){var o=$('<li class="menu-item"></li>');if(o.html(l[n].title),o.attr("data-x",t),o.attr("data-y",n),""!==l[n].shortcut){var s=$('<span class="shortcut"></span>');s.html(l[n].shortcut),o.append(s)}l[n].enabled||o.addClass("disabled"),e.append(o),o.click(function(){if(!$(this).hasClass("disabled")){var t=this.dataset.x,e=this.dataset.y;a[t].menuItems[e].handler(),d[t].css({display:"none"}),r=-1}})}else{var i=$('<li class="menu-hr"></li>');e.append(i)}e.css({width:a[t].width,left:a[t].left,display:"none"}),c.append(e),d.push(e)}}(),$("body").append(c)}return{show:function(t){a=t,e()}}}(),$editor=function(){var e=$('<div class="notepad-editor"><textarea spellcheck="false"></textarea></div>'),o=e.find("textarea");return o.css({"font-family":"Agency FB","font-style":"italic","font-weight":"bold","font-size":"20px"}),{show:function(){$("body").append(e),o.trigger("focus")},resize:function(t){t?e.css({bottom:"21px"}):e.css({bottom:"0"})},setWords:function(t,e,l,n){o.css({"font-family":t,"font-style":e,"font-weight":l,"font-size":n})}}}(),$dlgAbout=function(){var t=$('<div class="notepad-dlg-mask notepad-dlg-about"><div class="dialogbox notepad-dlgbox"><div class="notepad-dlg-titlebar"><p class="title">关于“记事本”</p><span class="close-btn">✖</span></div><div class="main notepad-dlg-main"><h1 class="slogan">JSNotepad</h1><hr><div class="info"><p>作者：夏佩敏</p><p>QQ：2536733090</p><p>仓库地址：<a href="https://github.com/xiapeimin/jsnotepad/" target="_blank">https://github.com/xiapeimin/jsnotepad/</a></p></div><input class="btn-ok btn" type="button" value="确定" autofocus></div></div></div>'),e=t.find(".btn-ok"),l=t.find(".close-btn"),n=t.find(".notepad-dlg-titlebar");function o(){t.remove()}return{show:function(){$("body").append(t),t.find(".dialogbox").draggable({handle:n}),e.focus(),e.click(o),l.click(o)}}}();function comList(){var o,l=$('<div class="notepad-com-list"><input class="editor" type="text"><br><ul class="list"></ul></div>'),n=l.find(".editor"),s=l.find(".list");window.localStorage.removeItem("select");var t=window.localStorage.getItem("family")||0,i=window.localStorage.getItem("style")||3,a=window.localStorage.getItem("size")||8,c={container:"",list:[],select:0,width:"200px",isFont:!1,isFontStyle:!1,selectHandler:null};function d(){var t,e=$(c.container).find(".notepad-com-list");0!==e.length&&e.remove(),$(c.container).append(l),l.css({width:c.width}),function(){var t,e,l,n=0;if(c.isFont)for(n=0;n<c.list.length;n++)(t=$('<li class="item"></li>')).css({"font-family":c.list[n]}),s.append(t.html(c.list[n]));else if(c.isFontStyle)for(n=0;n<c.list.length;n++)t=$('<li class="item"></li>'),e=t,"斜体"!==(l=c.list[n])?"粗体"!==l?"粗偏斜体"!==l||e.css({"font-weight":"bold","font-style":"italic"}):e.css({"font-weight":"bold"}):e.css({"font-style":"italic"}),s.append(t.html(c.list[n]));else for(n=0;n<c.list.length;n++)t=$('<li class="item"></li>'),s.append(t.html(c.list[n]));o=s.find(".item")}(),t=c.select,$(o[t]).addClass("selected"),n.val(c.list[t]),n.select()}this.show=function(e){".notepad-dlg-font .font-family"==e.container?e.select=t:".notepad-dlg-font .font-style"==e.container?e.select=i:".notepad-dlg-font .font-size"==e.container&&(e.select=a),$.extend(c,e),d(),s.click(function(t){$(o[c.select]).removeClass("selected"),c.select=c.list.indexOf($(t.target).html()),$(o[c.select]).addClass("selected"),n.val(c.list[c.select]),n.select(),c.selectHandler(c.select),".notepad-dlg-font .font-family"==e.container?window.localStorage.setItem("family",c.select):".notepad-dlg-font .font-style"==e.container?window.localStorage.setItem("style",c.select):".notepad-dlg-font .font-size"==e.container&&window.localStorage.setItem("size",c.select)}),n.keyup(function(){var t=0;for(t=0;t<c.list.length&&0!==c.list[t].indexOf(n.val());t++);t!==c.list.length&&(o[t].scrollIntoView({behavior:"smooth",block:"start"}),$(o[c.select]).removeClass("selected"),$(o[t]).addClass("selected"),c.select=t)})}}var $dlgFont=function(){var t=$('<div class="notepad-dlg-mask notepad-dlg-font"><div class="dialogbox notepad-dlgbox"><div class="notepad-dlg-titlebar"><p class="title">字体</p><span class="close-btn">✖</span></div><div class="main notepad-dlg-main"><div class="font-family"><p>字体(F):</p></div><div class="font-style"><p>字形(Y):</p></div><div class="font-size"><p>大小(S):</p></div><fieldset class="sample"><legend>示例</legend><p class="pfamily">AaBbYyZz</p></fieldset><div class="script"><label>脚本(R):<br><select><option value="西欧语言">西欧语言</option><option value="中文 GB2312">中文 GB2312</option></select></label></div><input class="btn-ok btn" type="button" value="确定"><input class="btn-cancel btn" type="button" value="取消"></div></div></div>'),o=t.find(".btn-ok"),s=t.find(".close-btn"),i=t.find(".btn-cancel"),a=t.find(".notepad-dlg-titlebar"),c=t.find(".pfamily");function d(){t.remove()}return c.css({"font-family":"Agency FB","font-style":"italic","font-weight":"bold","font-size":"20px"}),{show:function(){var e,l,n;$("body").append(t),e=["Agency FB","Algerian","Arial","Arial Rounded MT","Axure Handwriting","Bahnschrift","Baskerville Old Face","Bauhaus 93","Bell MT","Berlin Sans FB","Bernard MT","BlackAdder ITC"],l=["常规","斜体","粗体","粗偏斜体"],n=["8","9","10","11","12","14","16","18","20","22","24","26","28","36","48","72"],(new comList).show({container:".notepad-dlg-font .font-family",width:"176px",list:e,isFont:!0,selectHandler:function(t){c.css("font-family",e[t])}}),(new comList).show({container:".notepad-dlg-font .font-style",select:3,width:"132px",list:l,isFontStyle:!0,selectHandler:function(t){"常规"==l[t]?(c.css("font-style","normal"),c.css("font-weight","normal")):"斜体"==l[t]?(c.css("font-style","italic"),c.css("font-weight","normal")):"粗体"==l[t]?(c.css("font-weight","bold"),c.css("font-style","normal")):"粗偏斜体"==l[t]&&(c.css("font-weight","bold"),c.css("font-style","italic"))}}),(new comList).show({container:".notepad-dlg-font .font-size",width:"64px",list:n,selectHandler:function(t){c.css("font-size",n[t]+"px")}}),t.find(".dialogbox").draggable({handle:a}),s.click(d),i.click(d),o.click(d),o.click(function(){$editor.setWords(c.css("font-family"),c.css("font-style"),c.css("font-weight"),c.css("font-size")),d()})}}}(),note={config:{appContainer:".notepad-app"}};$(function(){$menubar.show(note.menuData),$editor.show()}),note.menuData=[{title:"文件(F)",menuItems:[{title:"新建(N)",shortcut:"Ctrl+N",enabled:!0,handler:function(){console.log("新建")}},{title:"打开(O)...",shortcut:"Ctrl+O",enabled:!0,handler:function(){console.log("打开")}},{title:"保存(S)",shortcut:"Ctrl+S",enabled:!0,handler:function(){console.log("保存")}},{title:"另存为(A)...",shortcut:"",enabled:!0,handler:function(){console.log("另存为")}},{title:"hr",shortcut:"",enabled:!0,handler:null},{title:"页面设置(U)...",shortcut:"",enabled:!0,handler:function(){console.log("页面设置")}},{title:"打印(P)...",shortcut:"Ctrl+P",enabled:!0,handler:function(){console.log("打印")}},{title:"hr",shortcut:"",enabled:!0,handler:null},{title:"退出(X)",shortcut:"",enabled:!0,handler:function(){console.log("退出")}}],width:"202px",left:"0px"},{title:"编辑(E)",menuItems:[{title:"撤销(U)",shortcut:"Ctrl+Z",enabled:!1,handler:function(){console.log("撤销")}},{title:"hr",shortcut:"",enabled:!0,handler:null},{title:"剪切(T)",shortcut:"Ctrl+X",enabled:!0,handler:function(){console.log("剪切")}},{title:"复制(C)",shortcut:"Ctrl+C",enabled:!1,handler:function(){console.log("复制")}},{title:"粘贴(P)",shortcut:"Ctrl+V",enabled:!1,handler:function(){console.log("粘贴")}},{title:"删除(L)",shortcut:"Del",enabled:!1,handler:function(){console.log("删除")}},{title:"hr",shortcut:"",enabled:!0,handler:null},{title:"使用 Bing 搜索...",shortcut:"Ctrl+E",enabled:!0,handler:function(){console.log("使用 Bing 搜索")}},{title:"查找(F)...",shortcut:"Ctrl+F",enabled:!1,handler:function(){console.log("查找")}},{title:"查找下一个(N)",shortcut:"F3",enabled:!1,handler:function(){console.log("查找下一个")}},{title:"替换(R)...",shortcut:"Ctrl+H",enabled:!0,handler:function(){console.log("替换")}},{title:"转到(G)...",shortcut:"Ctrl+G",enabled:!0,handler:function(){console.log("转到")}},{title:"hr",shortcut:"",enabled:!0,handler:null},{title:"全选(A)",shortcut:"Ctrl+A",enabled:!0,handler:function(){console.log("全选")}},{title:"时间/日期(D)",shortcut:"F5",enabled:!0,handler:function(){console.log("时间/日期")}}],width:"218px",left:"52px"},{title:"格式(O)",menuItems:[{title:"自动换行(W)",shortcut:"",enabled:!0,handler:function(){console.log("自动换行")}},{title:"字体(F)...",shortcut:"",enabled:!0,handler:function(){$dlgFont.show()}}],width:"156px",left:"106px"},{title:"查看(V)",menuItems:[{title:"状态栏(S)",shortcut:"",enabled:!0,handler:function(){console.log("状态栏")}}],width:"138px",left:"162px"},{title:"帮助(H)",menuItems:[{title:"查看帮助(H)",shortcut:"",enabled:!0,handler:function(){console.log("查看帮助")}},{title:"关于记事本(A)",shortcut:"",enabled:!0,handler:function(){$dlgAbout.show()}}],width:"166px",left:"216px"}];